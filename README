Mauve, Clonal Frame, Clonal Origin Analysis
===========================================

Bacteria species under study
----------------------------

bacillus
~~~~~~~~
A smaller data set seems to work with ClonalFrame.
I stopped at ClonalFrame's analysis with a smaller dataset.
I think that the running option that I use ClonalFrame seems okay.

Staphylococcus aureus
~~~~~~~~~~~~~~~~~~~~~
This should be analyzed similarly to that of B. cereus because recombination
rates seem comparable to those of B. cereus. The number of species is also
comparable.

Staphylococcus
~~~~~~~~~~~~~~
I want to test the hypothesis that is depicted by Figure 16.4 of the bacterial
population genetics book. See the page at 335 of the book.
Evolutionary scenario of S. epidermidis and S. aureus.
S. epidermidis has higher recombation rates than S. aureus. 
Did their most recent common ancestor have high recombination rates as S.
epidermidis?  Or, did it have low recombination rates as S. aureus?
There are 6 more genomes that are in Staphylococcus genus. These genomes should
inform us of the state of the ancestor of S. epidermidis and S. aureus.
I want to find one outgroup first.

Sulfolobus_islandicus
---------------------
There are 7 genomes.
Mauve alignment: PASS!
ClonalFrame (small): PASS!
ClonalOrigin: in progress...
This may be the first example that I can analyze with ClonalFrame and
ClonalOrigin.  

Sulfolobus
----------
Four more members of Sulfolobales are added.
There are 11 genome members of Sulfolobales.
Horizontal gene transfer can be studied using Clonal Origin.
Their timing can be summarized.
This data set of 11 genomes may not have a single species tree.

Sulfolobus8
-----------
We remove three genomes leaving 8 genomes.
We might study when genomic segments migrated between the 8-th genomes and each
of the 7 S. islandicus genomes.
I am interested in gene flow between the outgroup and the 7 ingroup genomes.

cornell6
--------
Two genomes sequenced at Cornell and four genomes publicly available are used. 

cornell5
--------
SEE is removed from the analysis of cornell6 because a whole genome may be
enough to root the tree, and the outgroup of SEE may not be necessary.
Two of three ClonalFrame runs seems concordant.  I proceed with the first stage
of ClonalOrigin analysis. 
Several blocks need more computing time than many others.

spyogenes
---------
I used 13 genomes. Two runs did not converge. Clonal frame is hard to obtain.
One of two runs seems stucked at a tree, and mixing was bad.
One of the runs runs okay. This is encouraging (Note the spyogenes6 did not
work, or R value increases to reach a plateau. 

spyogenes6
-----------
Each of three pairs of genomes are from the same M type. I remove one of each
pair. I also remove some to make a set of 6 species. The idea is if MCMC chains
converge and mix with a smaller number of species.
I see a similar problem: R value increases to reach a plateau.
I turn to cornell5 data set.

Burkholderia_cenocepacia
------------------------
This archea species include 4 genomes. Interestingly each genome consists of
multiple circular chromosomes or 3 chromosome. I combine the multiple
chromosomes to a single one. This can serve as a genome for ClonalFrame
analysis.
The analysis of archea may be interesting.

The genomes 1 and 2 are almost the same.
[literal]
cat ~/Elements/Documents/Projects/mauve/bacteria/Burkholderia_cenocepacia_MC0_3_uid58769/*.gbk > 1.gbk
union -sequence 1.gbk -sformat genbank -outseq 2.gbk -osformat genbank -feature Y -auto
mv 2.gbk Burkholderia_cenocepacia_MC0_3.gbk
rm 1.gbk


Salmonella_enterica
-------------------
I do not know what brought me to analyze this.
smaller clonal frame was finished.
The 16 genome data set clonalframe analysis failed to converge. I remove 4 of
them to have 12 genomes.  I stop this analysis until I know what I should do.
Obviously, I have to restart from 12 genome alignment using mauve.


Command Lines
-------------

To find genomes of a species
~~~~~~~~~~~~~~~~~~~~~~~~~~~~
[literal]
cd /Users/goshng/Elements/Documents/Projects/mauve/bacteria
[literal]
ls -l `find . -name *.gbk`| grep Staphylococcus_aureus > ~/Documents/Projects/mauve/species/Staphylococcus_aureus

To create a genome analysis
~~~~~~~~~~~~~~~~~~~~~~~~~~~
[literal]
bash sh/run.sh leptospira



Directories
-----------

cac
~~~
Examples of batch scripts for submitting jobs to CAC cluster.

streptococcus
~~~~~~~~~~~~~
Fourteen genomes are collated for a mauve analysis.

Problems
--------
ClonalFrame seems slow with increase in number of blocks.
Bacillus data set is hard to analyze with ClonalFrame. 
Streptococcus data set is smaller than Bacillus data set in size. 

streptococcus
~~~~~~~~~~~~~
N=14, b=471, L=603426
means that 14 genomes share 471 blocks that combine to be 603,426 in characters.
It would take about a week to run 20,000 generations of MCMC.

bacillus
~~~~~~~~
N=13, b=1200, L=3596990
means that 13 genomes share 1,200 blocks that combine to be 3,596,990 in
characters. This would take 8 days (or more than a week) to run 8,000
generations of MCMC.

External Programs
-----------------
Some perl scripts and c++ source files are prepared for helping mauve analyses.
- blocksplit2fasta.pl: A perl script that splits a core alignment to multiple
  fasta files. These fasta files are taken as input to
  compute_watterson_estimate to compute Watterson's estimate.
- blocksplit2smallerfasta.pl: A perl script that subsample blocks from a core
  alignment. 
- compute_watterson_estimate: A c++ source file that computes Watterson's
  estimates of DNA sequence alignments.
[literal]
/Users/goshng/Documents/Projects/biopp/bpp-test/compute_watterson_estimate.cpp
- Convert core to smaller core.
[literal]
usr/bin/core2smallercore.pl

Useful Bash Script
------------------
- To cancel multiple CAC jobs:
[literal]
for i in {1..419}; do tail -v -n 1 output/core_co.phase2.$i.xml >> 1; done

