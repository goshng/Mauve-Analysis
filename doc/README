Inferring genomic flow between _Streptococcus pyogenes_ and _S. dysgalactiae_ subspecies _equisimilis_ using whole genomes
==========================================================================================================================
:Author: Sang_Chul_Choi
:Author Initials: SCC

v1.0, January 2011:
Written for version 1 release.

v2.0, March 2011:
Rewritten for version 2 release.

Authors
-------
- Sang Chul Choi <goshng@gmail.edu>

IMPORTANT: Please, add your name and email addresses when you write or rewrite this
document.


//Contacts
//--------
//- Email: goshng@gmail.com
//- Phone: +1-607-542-9362
//- Address: Department of Biological Statistics & Computational Biology, 
//           Cornell University, Ithaca, NY 14853, USA

Keywords
--------
ancestral recombination graph (ARG),
group A streptococci (GAS),
group C streptococci (GCS),
group G streptococci (GGS),
restriction-modification system (RMS),
phosphoenolpyruvate:carbohydrate phosphotransferase system (PTS),
_Streptococcus pyogenes_ (SPY), 
_S. dysgalactiae_ spp. _dysgalactiae_ (SDD), and
_S. dysgalactiae_ spp. _equisimilis_ (SDE)

Abstract
--------
Group A streptococci (GAS) and group C/G streptococci (GCS/GGS) cohabit the same
ecological niche.  I investigate exchange of genetic elements between GAS and
GCS/GGS using their genomes.  The study shows that the two groups exchange genetic
segments across the entire genomes not just housekeeping genes.  
It shows that more genetic elements flowed overall
from GAS to GCS/GGS than the other direction.  
I find no evidence that virulence genes were exchanged more than other regions
of the genome. Three functional
categories show higher recombination rates: biosynthesis in fatty acid and
phospholipid metabolism, phosphoenolpyruvate:carbohydrate phosphotransferase
system (PTS) in signal transduction, and tRNA aminoacylation in protein fate.

Introduction
------------
Pathogenic bacteria infect many human diseases: e.g.,
food poisoning by _Eschericha Coli_,
strep throat by _Streptococcus pyrogenes_,
tuberculosis by _Mycobacterium tuberculosis_,
cholera by _Vibrio cholera_,
anthrax by _Bacillus anthracis_,
pneumonia by _Streptococcus pneumoniae_ and _Chlamydophila pneumoniae_, 
and influenza by _Haemophilus influenzae_, to name a few (a single CITE).
Among them,
_Streptococcus pyogenes_ belongs to group A streptococci (GAS)
that are a human-specific pathogen primarily infecting the throat and skin
(CITE). 
This human pathogen has high prevalence throughout the world
causing severe invasive streptococcal diseases:
pharyngitis also called strep throat, 
impetigo, 
cellulitis, 
necrotizing fasciitis,
toxic shock syndrome, 
acute rheumatic fever,
and acute glomerulonephritis (CITE). 
Its closely related species,
_Streptococcus dysgalactiae_ spp. _equisimilis_, belongs to group C or G
streptococci (GCS or GGS), once generally regarded as veterinary
pathogens (CITE).  Researchers have been confirming that GCS/GGS can
cause serious and life-threatening streptococcal diseases to human traditionally
associated with GAS (e.g., Brandt2009).  
Because _S. dysgalactiae_ spp. _equisimilis_ cohabits with _S. pyogenes_ 
at the same ecological niche of tissue sites,
they may as well exhibit overlap in the disease profile (Davies2007).
Therefore, genetic interaction between the two species may have played roles 
in formation of pathogenicity of _S. dysgalactiae_ spp. _equisimilis_.
Understanding the genetic exchange could enhance our
knowledge of their pathogenic effect on human health.
Previously experimental research in gene exchange between the two pyogeneic species was
limited to relatively smaller portion of the bacterial genome, mostly focusing
on virulence genes (Kalia2004, Towers2004, Bessen2005). 
Davies2007 tackled a genome-wide profiling of virulence genes of the two
species using microarrays.
An earlier attempt at resolving the direction of gene flow between the two
species seemed unfortunately premature (see Kalia2001).
Yet, certain virulence genes appear to have originated from one
to another, and vice versa (Bessen2010).

Lateral gene transfer in bacteria is so prevalent, and lack of gene exchange
is considered unusual in bacterial evolution (Didelot2010b).   
Biological mechanisms that induce lateral gene transfer include
conjugation by plasmid, transduction by bacteriophages, and transformation of
naked DNA uptake (Thomas2005).   Transferred DNAs through the machanisms replace
their endogenous homologs, involving homologous recombination (CITE).   
Bacteria appear to benefit from recombination to acquire genetic material that
is selectively advantageous (Vos2009).  Although lateral gene transfer by
homologous recombination has
driven bacterial evolution, methodological development has hardly been able to
deal with properly the important evolutionary force.

Bacterial phylogenetic studies recognized early on that lateral gene transfer would
complicate analyses of evolutionary relationships of the species (e.g.,
Woese1987).  Methods of infferring phylogenies in the presence of laternal gene
transfer have been proposed (e.g., Bapteste2004, Simonson2005, Beiko2009).
Yet, most of the methods use relatively small portion of bacterial genomes, which 
is an unfortunate situation: 
As sequencing costs plummet (Mardis2011), bacterial genomes sequencing produces
genomes of high quality in many bacterial species (Tettelin2009).
Given high prevalence of laternal gene transfer via homologous recombination in
bacteria, values of complete bacterial genomes must not be understated (Fraser2002).  
Development of downstream analysis methods using bacterial genomes appears
to lag behind that of high-throughput sequencing technology (e.g., Green2011).

Didelot2010 developed a powerful statistical method, and implemented it
into a software called ClonalOrigin.  The method uses a reference species tree
inferred using bacterial genomes.  The reference species tree
serves as a back-bone where additional edges, hereafter I refer to as recombinant
edges, are attached to the species tree branches.  
A recombinant edge connects two branches of the reference
tree.  The authors describe that a recombinant edge 
``departs'' from an older time point at a species branch, 
and ``arrives'' at a more recent time point of another species branch.  
The arrival point corresponds to a recombination event
in an ancestral recombination graph (ARG).  
As the reference tree traverses a genome alignment to
meet a recombinant edge, its sister branch of the arrival point is erased and
the recombinant edge replaces it.
Consequently, gene trees change sequentially along a genome.  
This reminisces about gene conversion modeling by Wiuf1999, and the sequential
Markov coalescent due to McVean2005.
Although recombinant edges between two species branches do not denote gene flow
between two species in their original model, Didelot2010 exploited their method
to infer flow of genetic segment between _Bacillus cereus_ species.

Here I applied the method of ClonalOrigin to 
scrutinze intensity of gene flow between the two species of 
_S. dysgalactiae_ spp. _equisimilis_ and _S. pyogenes_.
I hope that this study could be a step towards the understanding of interaction 
between the two closely related human pathogens. Specifically, I wish to answer 
to three questions. Firstly, did two species exchange genetic segments 
across the entire genome or parts of the genome?  What proportion of the genome
underwent higher recombination?  Secondly, if the two pyogenic
species exchanged genetic segments, was it overall unidirectional or bidirectional?
Thirdly, what classes of genes were exchanged if they exchanged genetic material? 
I organize the remainder of the paper as follows.  I describe the data set and its
analysis in Methods and Materials.  In Results, I provide evidence supporting my
answers to the questions of interest.  I end in Discussion.

Methods and Materials
---------------------
Briefly, a genome data set is described, which was also analyzed by
Suzuki2011.  The main procedure of using ClonalOrigin was described in 
Didelot2010.  A practical guide of the software could be found
at http://code.google.com/p/clonalorigin.  I also briefly described the
procedure, but I refer the users to Didelot2010 for further details.
Additionally, I summarized output of ClonalOrigin to answer to my specific
questions. 

ClonalOrigin pipeline
~~~~~~~~~~~~~~~~~~~~~
Two genomes of _S. pyogenes_, and one of _S. dysgalactiae_ ssp. _equisimilis_ 
were downloaded from GenBank with accessions: NC_004070 (Beres2002)
NC_008024 (Beres2006), and
NC_012891 (Shimomura2011).
Additional two genomes, each of _S. dysgalactiae_ ssp. _equisimilis_ 
and _S. dysgalactiae_ spp. _dysgalactiae_ were provided by Suzuki2011
with accession identifiers of SdeqATCC12394 and SddyATCC27957, respectively. 
I refer the two genomes of NC_004070 and NC_008024
as SPY1 and SPY2, respectively. 
The two genomes of SdeqATCC12394 and NC_012891 are referred to as SDE1 and
SDE2, respectively. Finally, the genome of 
_S. dysgalactiae_ spp. _dysgalactiae_ is referred to as SDD.
The five genomes were first aligned using 
progressiveMauve (Darling2004, Darling2010)
with default options that had been 
released on November 11th 2009 with version 2.3.1 at
http://asap.ahabs.wisc.edu/mauve/download.php.
I removed variable regions from the alignments to leave 
419 alignment blocks that were longer than 500 base pairs.
I excluded additional two alignment blocks because of too many gaps 
in their multiple alignments. Two more alignment blocks were excluded from a 
downstream analysis because 
the first stage of Markov chain Monte Carlo (MCMC) with
ClonalOrigin was not finished within a month of computation.
This filtered the alignment blocks to leave 415 core alignment blocks.
ClonalFrame version 1.1 that was available at 
http://www.xavierdidelot.xtreemhost.com/clonalframe.htm
was applied to the 415 alignment blocks to estimate a clonal frame, or 
or a species tree of the five genomes (Didelot2007). 
Independent runs of Markov chain Monte Carlo were executed with a total
generation of chains being 20,000. 
The first 10,000 generations were discarded as burn-in. 
A few species trees were estimated, from which I chose one based on its
likelihood.

ClonalOrigin with a subversion r19 released on October 1st 2010 was downloaded
from http://clonalorigin.googlecode.com/svn/trunk.
Two stages of MCMC with ClonalOrigin were used as described in Didelot2010.
The first one is used to 
obtain an estimate of population parameters such as mutation
rate, recombination rate, and recombinant tract length. 
The second stage of MCMC with ClonalOrigin was executed 
with the population parameters fixed to the estimated values in the previous
stage. This allowed to obtain a posterior sample of recombinant edges. 
Two independent runs of the first Markov chain Monte Carlo of ClonalOrigin were
executed with a total generation of each chain being 2,100,000. The first 1,100,000
generations of each chain were discarded as burn-in. The remaining 1,000,000
generations were subsampled every 10,000-th generation, leaving a posterior sample
of size 100. 
Additionally, Two independent
chains of the second ClonalOrigin Markov chain Montel Carlo were executed with a total
generation being 11,100,000. The first 1,100,000 generations of each chain were
discarded as burn-in. The remaining 10,000,000 generations were subsampled every
100,000 generations, leaving a sample of size 100. 

Recombinant edge count
~~~~~~~~~~~~~~~~~~~~~~
A species tree in the ClonalOrigin framework can include recombinant edges, each
of which exists only over a smaller region of an alignment block.  A recombinant
edge departs at an older time of one of the species tree branches, and arrives
at an earlier time of another branch.  As a reference species tree starts from
one side to another along the alignment, and meets a recombinant edge, the
arrival branch of the species tree is detached and regrafted to the departure
branch. The species tree sequentially change along the alignment.  The number of
recombinant edges along all of the alignment blocks could indicate overall
recombination event intensity.  
Didelot2010 summarized the
number of recombination events inferred relative to its expected number under
the prior of the ClonalOrigin model given recombination rate for each pair of
donor and recipient branches.
Note that departure branches are donors, and arrival branches are recipients.
The observed number of recombination events for a donor/recipient pair is equal
to the inferred number of recombinant edges across all of the alignment blocks.
The prior expected number of recombination events given a global recombination
rate is approximated using Equation 7 in Didelot2010. Practically, the prior
expected number of recombination events was computed per block using
ClonalOrigin. 
The point estimate of the ratio was the average value of the ratio over all the
posterior sample.  The sample variable of the ratio was also computed over the
posterior sample.  I interpreted the ratio of recombination events for a given
donor/recipient pair as a measure of gene flow from a donor to a recipient species
tree branch.

Recombination intensity
~~~~~~~~~~~~~~~~~~~~~~~
Overall recombination intensity, or measure of gene flow from a donor to a
recipient can be captured by
the observed number of recombination events relative to the prior expected
number of recombination events.  
Additionally, Didelot2010 provided another summary of
recombination events along a genome.  The summary measures the effect of donor
branches on a recipient species tree branch.  
Although the detailed procedure could be
different from that of Didelot2010, I used a similar approach to summarizing
recombination intensity along a genome, whic I describe as follows.

I measured how often a particular site along a genome is affected by
bacterial recombination.  A site of a block is affected by as many types of
recombinant edges as possible.  A type of recombinant edge is determined by the
departure and arrival branches of the reference species tree.  Sixty different
kinds of recombinant edges are possible in the species tree with five taxa.
Among the 60 types of recombinant edges 
32 pairs of branches are possible int an ultrametric species tree with
five taxa.  Not all types of the recombinant edges can correspond to legitimate
pairs of species tree branches for gene flow because some of branch pairs did
not exist at any past in time.  A recombinant edge can depart from a root edge
of a spcies tree and arrive at a leaf edge, and the recombinant edge cannot be
considered a channel that connect the two species tree branches.  I am
interested in gene flows 
between _S. pyogenes_ and _S. dysgalactiae_ ssp. _equisimilis_.  
Since they are at extant nodes,
pairs of species tree branches one from  _S. pyogenes_,
and another from _S. dysgalactiae_ ssp. _equisimilis_ can be
considered as gene flow channels.  Four ordered pairs of species branches
represent gene flow from _S. pyogenes_ to _S. dysgalactiae_ ssp. _equisimilis_.  
Another four ordered pairs represent gene flow 
from _S. dysgalactiae_ ssp. _equisimilis_ to _S. pyogenes_.

Functional categories under recombination
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
I used SPY1 genome for annotations.  The genbank formatted genome annotation was
downloaded from NCBI.  I downloaded JCVI role annotations of all JCVI annotated
genes at ftp://ftp.jcvi.org.  
I downloaded JCVI loci information of SPY1 genome at http://cmr.jcvi.org.  
I searched the JCVI CMV website for SPY1 genome to list JCVI loci. I compared
JCVI loci and NCBI locus_tag to find one-to-one association between JCVI
locus and NCCI locus_tag.  I downloaded bcp_go_role_link and bcp_role_link at
ftp://ftp.jcvi.org/pub/data/Omniome_Database/tab_delimited_omniome.
I used bcp_go_role_link to find gene ontology annotations for the JCVI loci.
The one-to-one associations were used to assign NCBI loci with their gene
ontology annotations and JCVI role annotations.
I listed roles at
http://cmr.jcvi.org/cgi-bin/CMR/shared/RoleList.cgi and parsed the HTML source
to find role categories and their identifiers.

For JCVI roles I can group locus tags by main roles or submain roles using the
numbers.  
I measured recombination intensity of a gene.  Recombination intensity of a gene
is an average weighted over the length of the gene in nucleotide.  
For each functional category of JCVI roles I divided genes into two groups where
one consists of genes with the corresponding functional category and another of
genes not annotated with the category.  Two-sample Kolmogorov-Smirnov tests were
performed for each functional category.
I also used the category of virulence genes from Davies2007 to test if virulence
genes were under higher or lower recombination. 

IMPORTANT: Mellisa has setup gene ontology analysis. I need to add gene ontology
analysis.

Gene gain, loss, duplication
~~~~~~~~~~~~~~~~~~~~~~~~~~~~
IMPORTANT: Matt is trying to find what we can do about gene gain, loss, and
duplication. 

Horizontal gene transfer
~~~~~~~~~~~~~~~~~~~~~~~~
IMPORTANT: I do not know yet what I should do about it.

Something other topic
~~~~~~~~~~~~~~~~~~~~~
IMPORTANT: +I need to find an interesting topic in bacterial recombination to
have enough contents to draft a manuscript.+


Simulation studies
~~~~~~~~~~~~~~~~~~
IMPORTANT: I cannot believe the method under the biological scenario. 
The simulation approach may be kin to *Bayesian model checking* 
in which I would check if the model I am using is appropriate. 
What should I show? I need to show that ClonalOrigin implementation recovers the
true ``values.'' What are the values? The three main parameters can be checked:
mutation rate, recombination rate, and recombinant tract length. Recombination
events should be checked although they are not just numerical values.

There are two simulation programs that were developed by Xavier Didelot. One is
SimMLST, and another is ClonalOrigin. SimMLST simulates data under the full
ancestral recombination graph. ClonalOrigin does under its own model.

.Parameters that I used for inferring recombination events
----
-T s0.0542 -D 1425 -R s0.00521
----

.A simulation setup
[options="header"]
|=====================================================
| Number of blocks | Total Length | mu  | rho  | delta
| 1                | 10 kb        | 542 | 52.1 | 1425
| 411              | Real data    | 542 | 52.1 | 1425
|=====================================================



WARNING: I do not think that I have parameters that control
directionality of gene flow due to bacterial recombinations. 
+I consider a simulation study where two populations share a common
ancestral population. 
In addition to the single recombination rate I have two
more recombination rates. These additional recombination rates are related with
migration in bacteria because homologous recombinations in bacteria often is
translated to lateral gene transfer. 
I label all the extant individuals two separate populations before
coalescent with recombination simulation. Two genomes in the same populations
can coalescent. Any two genomes from different populations are not allowed to
coalesce before they enter their common ancestral population. A splitting event
time is set to signal the entrance into a common ancestor. 
Two types of
recombination events are possible in the extant populations. One recombination
event generates a donor genome, which stays at the same population, and another
creates a donor, which migrates to the other population.
The two additional recombination rates implicitly accommodate migration rates.
The difference between the two recombination rates can be related to 
polarized gene flow between two extant populations. I did not pursue to make
inference of the model, and yet I wished to test ClonalOrigin's framework with
simulated data sets under the new model.+
I have been reconsider the above idea, and have realized that something should
be changed.
I think that the idea of having multiple recombination rates is hard to fit the
two population divergence model. Instead, I have two more coalescent events in
addition to the single recombination rate. Under the ancestral recombination
graph model individuals can ``spawn'' two parents.  Individuals can coalesce
within a population, or between populations.

WARNING: This is an old idea of having multiple recombination rates. I do think
that multiple coalescent rates with the single recombination rate can better fit
the ClonalOrigin model.
+Can I add something that does allow more recombinant
within a clade than between clades by having a ``splitting'' event?  I could
have three different recombination rates. This was the old idea that I had
before. One recombination rate is within a clade. A clade can be a present
population or an ancestral one. Another recombination rate is for a flow from
one present clade to another present clade. The other is for the reverse
direction of the flow. If the simulation approach can accommodate the three
recombination rates, then the inferrence method of ClonalOrigin should be able
to do so as well.+


Results
-------

Core- and pan-genome
~~~~~~~~~~~~~~~~~~~~
IMPORTANT: +Follow Darling2010 in the analysis of core- and pan-genome.+

The reference species tree
~~~~~~~~~~~~~~~~~~~~~~~~~~
Figure 1 shows the estimated species tree that relates the five streptococcal genomes.  
SPY1 and SPY2 form a clade while SDE1 and SDE2 form a separate clade. SDD is
connected to the lineage to the clade of SDE1 and SDE2.  
Mutation rate, $\theta$, was fixed to Watterson's estimate, or 106279.7. 
$\rho/\theta = 0.10$ with an interquartile range of (0.097,0.105) relative
mutation rate.  The average length $\delta = 370 bp$ with an interquartile range
of (355,384). $r/m = 4.7$ with an interquartile range of (4.5,4.9): more
substitutions are introduced by recombination than by mutation. 

Population parameter estimates
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
I applied the first stage of ClonalOrigin's MCMC to each of the alignment
blocks in order to estimate mutation rate, recombination rate, and recombination
tract length.  The median value for the recombination tract length $\delta$ was
1425 bp.  The median value for the per-site mutation rate $\theta_s/2$ was
0.0542.  The median value for the per-site recombination rate $\rho_s/2$ was
0.00521.  The median inferred value of $\rho/\theta$ was 0.096, which was
roughly equal to the corresponding value estimated by ClonalFrame. 
I proceeded to the second stage of ClonalOrigin's MCMC with values of $\delta$,
$\theta_s$, $\rho_s$ fixed to the estimated median values.

Genomic proportion under recombination
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Distribution of number of recombinant edge along the genome and its histogram.
I just concatenate alignment blocks to make a genome. 

IMPORTANT: +Compute the proportion of sites along all of the alignment blocks where the
average number of recombinant edges per site is less than 1.+

IMPORTANT: +Recombination intensity per site is used to quantify proportion of the genome
alignment under weak recombination or strong recombination.+ 

Proportion of sites with recombinant edges less than 1 could indicate proportion of
the genome where local gene tree and global species tree are similar to each
other.   This threshold 1 is arbitrary.  


Directional gene flow
~~~~~~~~~~~~~~~~~~~~~
Table 1 shows the observed number of recombinant edges relative to the prior
expected number of recombinant edges for each donor/recipient pair in the
species tree of the five genomes.  The ratios for the ordered pair from either
SPY1 or SPY2 to either SDE1 or SDE2 were 2.46, 2.48, 2.5, and 2.58.  The ratios
for the reverse direction were 1.16, 1.25, 1.47, and 1.59. The result appears to
indicate that gene flow from _Streptococcus pyogenes_ to
_S. dysgalactiae_ ssp. _equisimilis_ was larger than that for the reverse
direction. 

IMPORTANT: +COMPUTE THE VARIANCE.+ 

I compared recombination intensity for the direction
from _Streptococcus pyogenes_ to
_S. dysgalactiae_ ssp. _equisimilis_, and recombination intensity for the
reverse direction. 
Figure 3 shows the logarithm base 10 of the ratios for the genes
along SPY1 genome.  It indicates the overall unidirectional gene flow
from _Streptococcus pyogenes_ to _S. dysgalactiae_ ssp. _equisimilis_. 
It also indicates that the genes with unidirectional gene flow are uniformly
distributed across the SPY1 genome.

Function categories associated with higher recombination
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
IMPORTANT: +Draw the boxplots of recombination intensity for the functional
categories.+ 

Function categories show higher recombination rates: 
biosynthesis in fatty acid and phospholipid metabolism, 
(p-value of 0.0001642)
phosphoenolpyruvate:carbohydrate phosphotransferase system (PTS) in signal transduction, 
(p-value of 0.0002365)
tRNA aminoacylation in protein fate.
(p-value of 0.003271).

Divide the p-value by the number of functional categories in JCVI roles.


1. Total counts of events on average between species branches.
2. Import rate of a particular ordered pair of species branches along SPY1
genome.
3. Import rate of all ordered pairs of species branches along SPY1 genome.
4. Odd ratio of import rates to compare gene-flow-to-SDE and gene-flow-to-SPY
along SPY1 genome or SDE genome. 

IMPORTANT: +Functional categories and polarized direction. I think that I did
not find any association.+

IMPORTANT: +What virulence factors?+
Davies2007 studied 216 GAS virulence genes, not other genes
to profile the virulence gene repertoires of many (or 58) 
_Streptococcus dysgalactiae_ spp. _equisimilis_ isolates recovered during human
infections.

Discussions
-----------
Gene flow direction between 
_S. dysgalactiae_ spp. _equisimilis_ 
and _S. pyogenes_ has been questioned and challenged
(Kalia2001, Kalia2004, Towers2004, Bessen2005, and see Bessen2010). 
Until recently it was not possible because of lack of genome data and methods
that can handle them. Here I showcase a study that polarized direction of gene
flow seems broadly distributed across the entire genome. Additionally,
I found functional categories that were under higher recombination, and
consequently targets of lateral gene transfer.  Separate studies of association
of those functional categories with lateral gene transfer had been done.  These
fortified my finding of association of those functional categories with higher
recombination. 

I asked and answer to three questions.  
How did SDE evolve? Did it evolve from an ancestral form of pathogenic bateria?
Did it evolve from a commensal bacteria? Did genetic elements transfer from
SPY's lineage to SDE's? Or, were there cases of the opposite direction of gene
flow? In this study, I want to catalogue genetic elements according to their
pattern of flow in the evolutionary history that relates SPY and SDE. 
Kalia2001 conjectured two hypothetical scenarios of the evolution of the two
species: 
The first one is that the most recent common ancestor of SPY and SDE is a GAS-like pathogen. SDE
was losing virulence factors since the divergence of the ancestor. SDE regains
virulence factors from SPY because of the same niche.  
The second one is that the most recent common ancestor of SPY and SDE is a GGS/GCS-like commensal.
SPY evolves virulence factors since the divergence of the ancestor. SDE gains
virulence factors from SPY.

Directional gene flow
~~~~~~~~~~~~~~~~~~~~~
Flow of genomic regions between _Streptococcus pyogenes_ and 
_S. dysgalactiae_ spp. _equisimilis_ 
is investigated using five genomes including _S.
dysgalactiae_ spp. _dysgalactiae_.  Unidirectional flow of genomic regions
from _S. pyogenes_ to _S. dysgalactiae_ spp. _equisimilis_ is more prevalent
than the other direction.  
Two competing hypotheses on the evolution of the two species are tested.
I provide more evidence for hypothesis 1 with detailed view of evolutionary
history of the two Streptococci species.

Gene exchange via recombination among bacteria has driven bacterial evoltuion.
Bacterial recombinations happen more freely within the same species.  Barriers
to bacterial recombination can include geographic isolation. Geographic
isolation cannot be the only reason.  Genetic isolation can prevent
recombination between coinhating bacteria.  Restriction-modification system is a
biological self-defense mechanism of bacteria.  It is diverse in prokaryote
world.  Relatively unidirectional gene flow between  
_S. pyogenes_ and _S. dysgalactiae_ ssp. _equisimilis_ might be associated with
different restriction-modification system in the two species.  Most of 
_S. pyogenes_ genomes contain restriction-modification type I system as well as
type II system. The two genomes of _S. dysgalactiae_ ssp. _equisimilis_ contain
only type II system.  I conjecture that more tight self-defense system of 
_S. pyogenes_ might make the species less capable of aquiring foreign genetic
material from _S. dysgalactiae_ ssp. _equisimilis_.  I did not find evidence
against the hypothesis that functional categories of genes were independent of
polarization of gene flow between the two species.  Genes associated with 
polarized gene flow seem to be more or less randomly distributed across the
genome.  Kalia2001 discussed possible mechanisms of the polarized gene flow.
Kalia2001 mentioned potential roles of RMS in the polarized gene flow.
Budroni2011 studied that _Neisseria meningitidis_ phylogenetic clades were
associated with RMS.  Budroni2011 mentioned that RM systems modulate homologous
recombination in the bacteria of _N. meningitidis_.  Biological roles of RM
systems might be to maintain and control species identity (Jeltsch2003).

Considering the observation that recombination events happen across the entire
genome, I did not expect that some genes could be associated with higher
recombination.  I did find that ClonalOrigin's framework could help discover
functional categories of genes with higher recombination.  Some of functional
categories are a classical example where genes with the corresponding function
were under higher recombination, consequently leading to be under the force of
lateral gene transfer.  
A functional category of tRNA aminoacylation were reportedly associated with
higher lateral gene transfer by Woese2000. There are recent reports about tRNA
aminoacylation (Andam2010, Wang2011).
I found that PTS in signal transduction was associated with higher
recombination.  Zuniga2005 also found that PTS genes were more easily
transferred between bacteria. 
Function category of biosynthesis in fatty acid and phospholipid metabolism
was also found to be associated with higher recombination. 
Kinsella2003 studied lateral gene transfer of fatty acid metabolism.
Although I did not show that proof of concept, I do think that higher
recombination in _S. pyogenes_ has been known to be apparent in other studies 
(Vos2009a, Hanage2006, Perez-Losada2006).
Other corroborating studies seems to support that the three function categories
were under relatively higher recombination.

Evoultion from commensal to pathogenic
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Commensal bacteria could evolve by aquiring virulence genes from its closely
related bacteria that are pathogenic.  I expected that virulence genes of 
_S. dysgalactiae_ spp. _equisimilis_ 
might have been transferred from _S. pyogenes_. I could not find evidence to
support the lateral gene transfer of virulence genes from _S. pyogenes_ to
_S. dysgalactiae_ spp. _equisimilis_.
This marginally seem to support that virulence genes might
have existed in the common ancester of the two species.  I could not rule out
that virulence genes were transferred to 
_S. dysgalactiae_ spp. _equisimilis_.  The reports that 
_S. dysgalactiae_ spp. _equisimilis_ were human-pathogens seem to be
retropective.  
_Streptococcus dysgalactiae_ spp. _equisimilis_ had been known to infect
domesticated animals (CITEs).
Recently, reports that _S. dysgalactiae_ spp. _equisimilis_ (SDE) were recovered as
human pathogens just like _S. pyogenes_ (SPY) are increasing (CITEs).  
The species might have been human-pathogenic, and they were not
reported to be so much as _S. pyogenes_.  Further studies should be pursued to
resolve this issue of lateral gene transfer of virulence genes.

What did we learn from the analysis of ClonalOrigin?
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
Without account of recombination it seems to hard to study bacterial evolution
with a few exceptions.  My study is just a showcase of using a recently
developed statistical software of ClonalOrigin to apply it to two groups of
genomes to answer three questions.  Although the analysis using ClonalOrigin
requires a series of analyses, the approach is based on a sound statistical
model of coalescent with recombination.  

Lack of analyses and Limitations of the method
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
I used only 
two genomes of _S. pyogenes_,
and two genomes of _S. dysgalactiae_ spp. _equisimilis_ with additional genome
from _S. dysgalactiae_ spp. _dysgalactiae_. 
Additional to the five genomes from closely related species could increase the
power of detecting recombination.  
Analyses with more isolates could potentially reveal congruent relationships
between virulence profiles and GCS/GGS disease propensity.
I also used only core genomes where not so much gaps were allowed.  
Relatively short alignment blocks were excluded from the analysis.
Alignment blocks with many gaps were excluded.  
With this inherent filtering of the input data preparation
I did not account for gene gain and loss in the analysis. 
Only well aligned regions were used in the analysis.  More complicated
evolutionary models could have been considered: genome rearrangement, gene
segment gain and loss, and gene duplications.  Without these evolutionary events
in their model Didelot2010 still used the two stages of Bayesian approach where
the second stage uses the result from the first stage as a prior.  
If this compromise seems to be necessary due to smaller uncertainty of some
parameters and computational cost, using whole genomes intact with all
alignment blocks seems to be impracticable.  Incorporating the other
evolutionary events in the ClonalOrigin's framework seems
to be out of the question.  It seems to be natural to consider some of
evolutionary models such as gene segment gain and loss
becasue bacterial genomes are the ultimate resources for resolving many
biological questions such as species tree of them.  I am wondering if species
tree can be studied using gene tree model that Didelot2010 developed in
ClonalOrigin.

Delorme:2007 indicated that _S. salivarius_ and _S. vestibularis_ may have
evolutionary history that is parallel to _SDE_ and _S. pyogenes_.

Divergence time estimation
~~~~~~~~~~~~~~~~~~~~~~~~~~
Kalia2001 suggested the divergence time of 
_S. dysgalactiae_ spp. _dysgalactiae_ (SDD) to be around the time when human
started to domesticate wildlife animals around 10,000 years ago. A demographic
model could be made with two species to study the divergence time
quantitatively. This would require ancestral recombination graphs
embedded in a species tree.  

Acknowledgments
---------------
Adam Siepel,
Ilan Gronau,
Melissa Jane Hubisz,
Xavier Didelot,
Matt Rasmussen,
Grant information

References
----------
. Ahmad et al. 2009. J Clin Microbiol. 2009 July; 47(7): 2046–2054. Published online 2009 April 22. doi: 10.1128/JCM.00246-09.
. Bessen et al. Evolution of transcription regulatory genes is linked to niche
specialization in the bacterial pathogen Streptococcus pyogenes. J Bacteriol. 2005 Jun;187(12):4163-72.
. Beres SB, Sylva GL, Barbian KD, Lei B, Hoff JS, Mammarella ND, Liu MY, Smoot JC,
Porcella SF, Parkins LD, Campbell DS, Smith TM, McCormick JK, Leung DY,
Schlievert PM, Musser JM.
Genome sequence of a serotype M3 strain of group A Streptococcus: phage-encoded
toxins, the high-virulence phenotype, and clone emergence.
Proc Natl Acad Sci U S A. 2002 Jul 23;99(15):10078-83. Epub 2002 Jul 16.
. Beres SB, Richter EW, Nagiec MJ, Sumby P, Porcella SF, DeLeo FR, Musser JM.
Molecular genetic anatomy of inter- and intraserotype variation in the human
bacterial pathogen group A Streptococcus.
Proc Natl Acad Sci U S A. 2006 May 2;103(18):7059-64. Epub 2006 Apr 24.
. Cohan, F. M. 2001. Bacterial species and speciation. Syst. Biol. 50:513–524.
. Darling, A. C., B. Mau, F. R. Blattner and N. T. Perna, 2004 Mauve: multiple
alignment of conserved genomic se- quence with rearrangements. Genome Res. 14:
1394–1403.
. Darling, A., B. Mau and N. Perna, 2010  ProgressiveMauve: multi- ple genome
alignment with gene gain, loss and rearrangement. PLoS One 5: e11147.
. Davies et al. Virulence profiling of Streptococcus dysgalactiae subspecies
equisimilis isolated from infected humans reveals 2 distinct genetic lineages
that do not segregate with their phenotypes or propensity to cause diseases. 
Clin Infect Dis. 2007 Jun 1;44(11):1442-54. Epub 2007 Apr 19.
. Delorme et al. Extent of Horizontal Gene Transfer in Evolution of Streptococci
of the Salivarius Group. JOURNAL OF BACTERIOLOGY, Feb. 2007, p. 1330–1341
. Didelot, X., and D. Falush, 2007  Inference of bacterial microevo- lution using
multilocus sequence data. Genetics 175: 1251–1266.
. Didelot, X., and M. C. Maiden, 2010.  Impact of recombination on bacterial
evolution. Trends Microbiol. 18: 315–322.
. Didelot, X., D. Lawson, A. Darling, and D. Falush, 2010.
Inference of Homologous Recombination in Bacteria Using Whole-Genome Sequences.
Genetics 186: 1435–1449 (December 2010)
. Enright, R. Goldstein, D. Hood, A. Kalia, C. E. Moore, J. Zhou, and B. G.
Spratt. 2001. Recombination within natural populations of pathogenic bacteria:
short-term empirical estimates and long-term phylogenetic consequences. Proc. Natl. Acad. Sci. USA 98:182–187. [NOT YET READ]
. Feil, E. J., E. C. Holmes, D. E. Bessen, M.-S. Chan, N. P. J. Day, M. C.  Enright, R. Goldstein, D. Hood, A. Kalia, C. E. Moore, J. Zhou, and B. G.  Spratt. 2001. Recombination within natural populations of pathogenic bac- teria: short-term empirical estimates and long-term phylogenetic conse- quences. Proc.  Natl. Acad. Sci. 98:182–187.
. Fraser, C. M.; Eisen, J. A.; Nelson, K. E.; Paulsen, I. T. & Salzberg, S. L.,
2002 The value of complete microbial genome sequencing (you get what you pay
for). J Bacteriol 184: 6403-5; discusion 6405.
. Green, E. D.; Guyer, M. S. & Institute, N. H. G. R., 2011 Charting a course
for genomic medicine from base pairs to bedside. Nature 470: 204-213.
. Mardis, E. R., 2011 A decade's perspective on DNA sequencing technology.
Nature 470: 198-203. 
. Nigel Goldenfeld, and  Carl Woese. Biology's next revolution. Nature 445, 369 (25 January 2007)
. Jeffrey G. Lawrence. Gene Transfer in Bacteria: Speciation without Species? 
Theoretical Population Biology 61, 449–460 (2002) doi:10.1006/tpbi.2002.1587
. Johnson PLF, Slatkin M (2009) Inference of Microbial Recombination Rates from
Metagenomic Data. PLoS Genet 5(10): e1000674. doi:10.1371/ journal.pgen.1000674
. Kalia et al. Directional gene movement from human-pathogenic to commensal-like
streptococci. Infect Immun. 2001 Aug;69(8):4858-69. [THIS PAPER WAS RETRACTED
DUE TO SOME PROBLEM THAT I DID NOT KNOW]  
. Kalia, A., B. G. Spratt, M. C. Enright, and D. E. Bessen. 2002. Influence of
recombination and niche separation on the population genetic structure of the
pathogen Streptococcus pyogenes. Infect. Immun. 70:1971–1983 [NOT YET READ]
. Kalia A., and D. E. Bessen. Natural Selection and Evolution of Streptococcal Virulence Genes Involved in Tissue-Specific Adaptations. Journal of Bacteriology, January 2004, p. 110-121, Vol. 186, No. 1 
. Bethany N. Kent, Leonidas Salichos, John G. Gibbons, Antonis Rokas, Irene L.G.
Newton, Michael E. Clark, and Seth R. Bordenstein
Complete Bacteriophage Transfer in a Bacterial Endosymbiont (Wolbachia)
Determined by Targeted Genome Capture
Genome Biol Evol first published online February 2, 2011 doi:10.1093/gbe/evr007
. Kilian M, Poulsen K, Blomqvist T, Håvarstein LS, Bek-Thomsen M, et al. (2008) Evolution of Streptococcus pneumoniae and Its Close Commensal Relatives. PLoS ONE 3(7): e2683. doi:10.1371/journal.pone.0002683
. Kinsella, R. J.; Fitzpatrick, D. A.; Creevey, C. J. & McInerney, J. O., 2003
Fatty acid biosynthesis in Mycobacterium tuberculosis: lateral gene transfer,
adaptive evolution, and gene duplication. Proc Natl Acad Sci U S A 100:
10320-10325.
. Maiden, M. C. J., J. A. Bygraves, E. Feil, G. Morelli, J. E. Russell et al.,
1998  Multilocus sequence typing: a portable approach to the identification of
clones within populations of pathogenic mi- croorganisms. Proc. Natl. Acad. Sci.
USA 95: 3140–3145.
. McVean, G. A. and Cardin, N. J. 2005. Approximating the coalescent with
recombination. Philos. Trans. R. Soc. Lond. B Biol. Sci., 360, 1387–93.
. Schmidt, H., and M. Hensel. 2004. Pathogenicity islands in bacterial
pathogenesis. Clin. Microbiol. Rev. 17:14–56. [NOT YET READ]
. Shimomura Y, Okumura K, Murayama SY, Yagi J, Ubukata K, Kirikae T,
Miyoshi-Akiyama T.
Complete genome sequencing and analysis of a Lancefield group G Streptococcus
dysgalactiae subsp. equisimilis strain causing streptococcal toxic shock
syndrome (STSS).
BMC Genomics. 2011 Jan 11;12:17.
. Suzuki, H., Tristan Lefebure, Melissa Jane Hubisz, Paulina Pavinski Bitar,
Ping Lang, Adam Siepel, and Michael J. Stanhope.
Comparative genomic analysis of the Streptococcus dysgalactiae species group:
gene content, molecular adaptation, and promoter evolution.
Genome Biol Evol first published online January 31, 2011 doi:10.1093/gbe/evr006
. Tettelin, H. & Feldblyum, T., 2009 Bacterial genome sequencing. Methods Mol
Biol 551: 231-247.
. The Gene Ontology.
Consortium Gene Ontology: tool for the unification of biology. (2000) Nature Genet. 25: 25-29 
. Thomas, C. M. & Nielsen, K. M., 2005 Mechanisms of, and barriers to,
horizontal gene transfer between bacteria. Nat Rev Microbiol 3: 711-721.
. Towers et al. Fibronectin-binding protein gene recombination and horizontal transfer between group A and G streptococci.  J Clin Microbiol. 2004 Nov;42(11):5357-61.
. Feil, E. J., E. C. Holmes, D. E. Bessen, M.-S. Chan, N. P. J. Day, M. C.
. Wang, X. & Lavrov, D. V., 2011 Gene recruitment - A common mechanism in the
evolution of transfer RNA gene families. Gene 475: 22-29.
. Wiuf, C. and Hein, J. 1999. Recombination as a point process along sequences.
Theor. Pop. Biol., 55, 248–259.
. Woese, C. R. Bacterial Evolution. MICROBIOLOGICAL REVIEWS, June 1987, p. 221-271 
. Woese, C. R.; Olsen, G. J.; Ibba, M. & Söll, D., 2000 Aminoacyl-tRNA
synthetases, the genetic code, and the evolutionary process. Microbiol Mol Biol
Rev 64: 202-236.
. Zúñiga, M.; Comas, I.; Linaje, R.; Monedero, V.; Yebra, M. J.; Esteban, C. D.;
Deutscher, J.; Pérez-Martínez, G. & González-Candelas, F., 2005 Horizontal gene
transfer in the molecular evolution of mannose PTS transporters. Mol Biol Evol
22: 1673-1685.

Tables
------

///////
Table 1
///////
.Number of recombination events inferred relative to its expected number under the prior model given recombination rate for each donor/recipient pairs of species branches. Species of rows are donors, and speices of columns are recipients.
[format="dsv",separator="\s",options="header"]
|===================================================
 SDE1 SDE2 SDD SPY1 SPY2 SDE SPY SD R
include::table1.txt[]
|===================================================

Figure Legends
--------------
Figure 1. The reference species tree of the five streptococcal genomes. 
SDE1 and SDE2 represent genomes for 
_Streptococcus dysgalactiae_ spp. _equisimilis_.
SPY1 and SPY2 represent genomes for _S. pyogenes_.
SDD is the genome for 
_S. dysgalactiae_ spp. _dysgalactiae_. The scale is proportional to the expected
number of mutations in the branch given the inferred value of 
$\theta$ and $\Tau$. Internal nodes including the root are labeled.

Figure 2. 

Figure 3.

Figure 4.

Figures
-------

////////
Figure 1
////////
.Phylogeny of the five genomes.
image::figure1.png[Clonal frame]

////////
I describe the parameter values in the text:
estimates of recombination rates, mutation rates, and recombinant tract lengths.
////////

/////////
Figure 2.
Posterior probability of 60 different imports along SDE1 genomes.
Posterior probability of import along SDE1 genome.
/////////
.Posterior probability of 60 different imports along SDE1 genomes.
image::figure2.png[Posterior probability]

/////////
Figure 3.
Odd ratios of posterior probability of import between SDE and SPY along SDE1 genome.
Odd ratios of posterior probability of import between SDE and SPY by locus genes.
/////////
.Odd ratios of posterior probability of import between SDE and SPY by locus genes.
image::figure3.png[Posterior probability]


/////////
Figure 4.
Import rates for JCVI role categories.
/////////
.Functional categories and import rates.
image::figure4.png[Functional categories]

END OF MANUSCRIPT
-----------------

